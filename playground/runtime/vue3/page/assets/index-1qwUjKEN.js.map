{"version":3,"file":"index-1qwUjKEN.js","sources":["../../../../../../vue-components/overlay/src/index.vue"],"sourcesContent":["<template>\n  <magic-ui-container v-if=\"visible\" :config=\"{ items: config.items }\">\n    <slot></slot>\n  </magic-ui-container>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, onBeforeUnmount, type PropType, ref } from 'vue-demi';\n\nimport type { Id, MContainer, MNode, MPage } from '@tmagic/schema';\nimport { useApp } from '@tmagic/vue-runtime-help';\n\ninterface OverlaySchema extends Omit<MContainer, 'id'> {\n  id?: Id;\n  type?: 'overlay';\n}\n\nexport default defineComponent({\n  props: {\n    config: {\n      type: Object as PropType<OverlaySchema>,\n      required: true,\n    },\n    iteratorIndex: Array as PropType<number[]>,\n    iteratorContainerId: Array as PropType<Id[]>,\n    model: {\n      type: Object,\n      default: () => ({}),\n    },\n  },\n\n  setup(props) {\n    const visible = ref(false);\n\n    const { app, node } = useApp({\n      config: props.config,\n      iteratorContainerId: props.iteratorContainerId,\n      iteratorIndex: props.iteratorIndex,\n      methods: {\n        openOverlay() {\n          visible.value = true;\n          app?.emit('overlay:open', node);\n        },\n        closeOverlay() {\n          visible.value = false;\n          app?.emit('overlay:close', node);\n        },\n      },\n    });\n\n    const editorSelectHandler = (\n      info: {\n        node: MNode;\n        page: MPage;\n        parent: MContainer;\n      },\n      path: MNode[],\n    ) => {\n      if (path.find((node: MNode) => node.id === props.config.id)) {\n        node?.instance.openOverlay();\n      } else {\n        node?.instance.closeOverlay();\n      }\n    };\n\n    app?.page?.on('editor:select', editorSelectHandler);\n\n    onBeforeUnmount(() => {\n      app?.page?.off('editor:select', editorSelectHandler);\n    });\n\n    return {\n      visible,\n    };\n  },\n});\n</script>\n"],"names":["_sfc_main","props","visible","app","node","useApp","editorSelectHandler","info","path","node2","_a","_component_magic_ui_container","_ctx"],"mappings":"+FAiBA,MAAeA,EAAA,QAAgB,gBAAA,CAAA,MAAA,CACtB,OAAA,CACG,KAAA,OACA,SAAA,EACI,EACZ,cAAA,MACe,oBAAA,MACM,MAAA,CACd,KAAA,OACC,QAAA,KAAA,CAAA,EACW,CACnB,EACF,MAAAC,EAAA,OAGE,MAAAC,EAAgB,gBAEhB,CAAA,IAAAC,EAAA,KAAAC,CAAA,EAAAC,EAAA,CAA6B,OAAAJ,EAAA,OACb,oBAAAA,EAAA,oBACa,cAAAA,EAAA,cACN,QAAA,CACZ,aAAA,CAELC,EAAA,MAAA,GACAC,GAAA,MAAAA,EAAA,KAAA,eAAAC,EAA8B,EAChC,cAAA,CAEEF,EAAA,MAAA,GACAC,GAAA,MAAAA,EAAA,KAAA,gBAAAC,EAA+B,CACjC,CACF,CAAA,EAGFE,EAAA,CAAAC,EAAAC,IAAA,CAQEA,EAAA,KAAAC,GAAAA,EAAA,KAAAR,EAAA,OAAA,EAAA,EACEG,GAAA,MAAAA,EAAA,SAAA,cAEAA,GAAA,MAAAA,EAAA,SAAA,cACF,EAGF,OAAAM,EAAAP,GAAA,YAAAA,EAAA,OAAA,MAAAO,EAAA,GAAA,gBAAAJ,GAEA,QAAA,gBAAA,IAAA,QACEI,EAAAP,GAAA,YAAAA,EAAA,OAAA,MAAAO,EAAA,IAAA,gBAAAJ,EAAmD,CAAA,EAGrD,CAAO,QAAAJ,CACL,CACF,CAEJ,CAAA,0BA1EmC,MAAAS,EAAA,IAAA,iBAAA,oBAAA,EADnC,OAAAC,EAAA,SAAA,IAAA,UAAA,qBACmE,IAAA,+BAClD,EAAA,0BAFjB,IAAA,WAAAA,EAAA,OAAA,SAAA,CAAA,CAAA,EAAA,EAAA,CAAA,EAAA,EAAA,CAAA,QAAA,CAAA,GAAA,IAAA,mBAAA,GAAA,EAAA"}